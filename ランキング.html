<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mario Tennis Fever Community Records</title>

<meta property="og:title" content="Mario Tennis Fever Community Records">
<meta property="og:description" content="コミュニティ大会のレコードページ">
<meta property="og:type" content="website">
<meta property="og:url" content="https://963game.github.io/ランキング.html">

<!-- ★ここから強化版 -->
<meta property="og:image" content="https://963game.github.io/images/ogp.png?v=1">
<meta property="og:image:secure_url" content="https://963game.github.io/images/ogp.png?v=1">
<meta property="og:image:type" content="image/png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<!-- ★ここまで -->

<meta name="twitter:card" content="summary_large_image">

  <style>
    :root{
      --bg:#0b0e14; --line:#23304a;
      --text:#e9eefc; --muted:#9fb0d0;
      --accent:#b86bff; --accent2:#6ee7ff;
      --gold:#ffd56a; --silver:#c7d2fe; --bronze:#f2b38f;
    }
    *{box-sizing:border-box}
body{
  margin:0;
  color:var(--text);
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;

  background:
    linear-gradient(rgba(11,14,20,0.70), rgba(11,14,20,0.78)),
    url("https://963game.github.io/images/スクリーンショット 2026-02-14 224903.png") center / cover no-repeat fixed,
    radial-gradient(1200px 600px at 18% 8%, rgba(184,107,255,0.18), transparent 60%),
    radial-gradient(1200px 600px at 82% 12%, rgba(110,231,255,0.14), transparent 55%),
    var(--bg);

  padding:18px 12px 36px;
}
    .wrap{max-width:980px;margin:0 auto}
    header{display:flex;justify-content:space-between;gap:12px;align-items:flex-end;flex-wrap:wrap;margin:6px 0 10px}
    h1{margin:0;font-size:20px;letter-spacing:.3px}
    .sub{margin:6px 0 0;color:var(--muted);font-size:12px}

    .pill{
      display:inline-flex;gap:8px;align-items:center;
      border:1px solid rgba(184,107,255,0.35);
      background:rgba(184,107,255,0.10);
      padding:8px 10px;border-radius:999px;
      font-size:12px;color:var(--muted);
      max-width: 100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .pill b{color:var(--text)}

    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 12px}
    .tab{
      border:1px solid var(--line); background:rgba(18,24,38,0.65);
      color:var(--muted); padding:10px 12px; border-radius:12px; cursor:pointer;
      user-select:none; font-size:13px;
    }
    .tab.active{
      border-color:rgba(184,107,255,0.7);
      background:linear-gradient(180deg, rgba(184,107,255,0.20), rgba(18,24,38,0.65));
      color:var(--text);
    }

    .card{
      border:1px solid var(--line);
      background:rgba(18,24,38,0.88);
      border-radius:18px; overflow:hidden;
      box-shadow:0 10px 40px rgba(0,0,0,.35);
    }
    /* ★更新情報だけ色を変える */
   .card.info{
  border-color: var(--line);
  background: rgba(18,24,38,0.88); /* ← .card と同じにする */
}

    .card h2{
      margin:0; padding:12px 12px 10px;
      font-size:13px; letter-spacing:.25px;
      border-bottom:1px solid rgba(35,48,74,0.75);
      display:flex;justify-content:space-between;gap:10px;align-items:center;
    }
    .tag{
      display:inline-flex;gap:6px;align-items:center;
      padding:4px 8px;border-radius:999px;
      border:1px solid rgba(159,176,208,0.25);
      background:rgba(159,176,208,0.08);
      color:var(--muted); font-size:12px;
      white-space:nowrap;
    }

    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{padding:9px 10px;border-bottom:1px solid rgba(35,48,74,0.55);text-align:left}
    th{color:var(--muted);font-weight:600;font-size:12px}
    tr:last-child td{border-bottom:none}

    .rank{width:64px;font-variant-numeric:tabular-nums}
    .right{text-align:right}
    .mono{font-variant-numeric:tabular-nums;font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
    .muted{color:var(--muted)}

    .badge{
      display:inline-flex;align-items:center;gap:6px;
      padding:4px 8px;border-radius:999px;
      border:1px solid rgba(159,176,208,0.25);
      background:rgba(159,176,208,0.08);
      font-size:12px;
    }
    .r1{border-color:rgba(255,213,106,0.6);background:rgba(255,213,106,0.12)}
    .r2{border-color:rgba(199,210,254,0.6);background:rgba(199,210,254,0.10)}
    .r3{border-color:rgba(242,179,143,0.55);background:rgba(242,179,143,0.10)}

    .row{display:none}
    .row.active{display:block}

    /* 1 / 1 / 2 */
    .stack{display:grid;grid-template-columns:1fr;gap:12px}
    .twoCol{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:820px){ .twoCol{grid-template-columns:1fr} }

/* 更新情報：5行くらい表示して中だけスクロール */
.infoBox{
  padding:10px 12px;
  color:var(--muted);
  font-size:12px;
  line-height:1.7;

  max-height: 8.7em;      /* 1行(1.7em) × 約5行 = 8.5em くらい */
  overflow-y: auto;
  overflow-x: hidden;

  /* スクロールしてる感を抑える */
  scrollbar-gutter: stable;
}

.infoBox{
  scrollbar-width: thin;              /* Firefox */
  scrollbar-color: rgba(159,176,208,0.35) transparent;
}
.infoBox::-webkit-scrollbar{ width: 10px; }
.infoBox::-webkit-scrollbar-thumb{
  background: rgba(159,176,208,0.25);
  border-radius: 999px;
  border: 3px solid transparent;
  background-clip: content-box;
}

  </style>
</head>

<body>
<div class="wrap">
  <header>
    <div>
      <h1>Mario Tennis Fever Community Records</h1>
      <div class="sub">フィーバー/クラシック・オンライン/オフライン混同。記録を育てるレコードページ。</div>
    </div>
    <div class="pill" id="pillText">配点：<b id="pointsLabel"></b></div>
  </header>

  <div class="tabs" id="tabs"></div>

  <!-- Singles -->
  <section id="singles" class="row active">
    <div class="stack">
      <div class="card info">
        <h2>更新情報 <span class="tag"><span style="color:var(--accent)">●</span> info</span></h2>
        <div class="infoBox">
          <div>✅ 追記は <span class="mono">events</span> に大会結果を足すだけ</div>
          <div>✅ 部門枠は <span class="mono">累計ポイント上位（ベスト記録）</span> を表示</div>
          <div>✅ 総合は <span class="mono">合計pt / 優勝 / 出場</span> を集計</div>
          <div>最新（フィーバー）：<span id="latestSinglesFever" class="mono"></span></div>
          <div>最新（クラシック）：<span id="latestSinglesClassic" class="mono"></span></div>
          <div>更新：<span id="updatedAtS" class="mono"></span></div>
        </div>
      </div>

      <div class="card">
        <h2>シングルス総合（個人） <span class="tag"><span style="color:var(--accent2)">◆</span> points / wins / plays</span></h2>
        <div style="overflow:auto">
          <table>
            <thead>
              <tr><th>順位</th><th>プレイヤー</th><th class="right">合計pt</th><th class="right">優勝</th><th class="right">出場</th></tr>
            </thead>
            <tbody id="singlesOverall"></tbody>
          </table>
        </div>
      </div>

      <div class="twoCol" id="singlesBoards"></div>
    </div>
  </section>

  <!-- Doubles -->
  <section id="doubles" class="row">
    <div class="stack">
      <div class="card info">
        <h2>更新情報 <span class="tag"><span style="color:var(--accent)">●</span> info</span></h2>
        <div class="infoBox">
          <div>✅ ダブルスは <span class="mono">チームptを2人に等分</span>して個人に加算</div>
          <div>✅ 部門枠は <span class="mono">累計ポイント上位（ベスト記録）</span></div>
          <div>✅ ペア固定が難しい前提で、表示も集計も“個人”中心</div>
          <div>最新（フィーバー）：<span id="latestDoublesFever" class="mono"></span></div>
          <div>最新（クラシック）：<span id="latestDoublesClassic" class="mono"></span></div>
          <div>更新：<span id="updatedAtD" class="mono"></span></div>
        </div>
      </div>

      <div class="card">
        <h2>ダブルス総合（個人） <span class="tag"><span style="color:var(--accent2)">◆</span> split points</span></h2>
        <div style="overflow:auto">
          <table>
            <thead>
              <tr><th>順位</th><th>プレイヤー</th><th class="right">合計pt</th><th class="right">優勝</th><th class="right">出場</th></tr>
            </thead>
            <tbody id="doublesOverall"></tbody>
          </table>
        </div>
      </div>

      <div class="twoCol" id="doublesBoards"></div>
    </div>
  </section>
</div>

<script>
  // ===== 配点（固定）===== 2倍スケール（整数化）
  const singlesPoints = {1:20,2:16,3:12,4:10,5:8,6:6,7:4,8:2};
  const doublesTeamPoints = {...singlesPoints};
  const doublesPerPerson = (rank)=> (doublesTeamPoints[rank] ?? 0) / 2;

  // ===== ここが「裏入力」：大会ごとに追加していく =====
  // tournament（大会名）を入れるだけで更新情報に反映される
  const events = [
    {
      date: "2026-02-01",
      tournament: "Fever Singles #01",
      type: "singles",
      mode: "fever",
      note: "online",
      results: [
        {rank:1, player:"PlayerA"},
        {rank:2, player:"PlayerB"},
        {rank:3, player:"PlayerC"},
      ]
    },
    {
      date: "2026-02-03",
      tournament: "Classic Singles #01",
      type: "singles",
      mode: "classic",
      note: "offline",
      results: [
        {rank:1, player:"PlayerB"},
        {rank:2, player:"PlayerA"},
      ]
    },
    {
      date: "2026-02-05",
      tournament: "Fever Doubles #01",
      type: "doubles",
      mode: "fever",
      note: "online",
      results: [
        {rank:1, p1:"PlayerA", p2:"PlayerC"},
        {rank:2, p1:"PlayerB", p2:"PlayerD"},
      ]
    },
    {
      date: "2026-02-07",
      tournament: "Classic Doubles #01",
      type: "doubles",
      mode: "classic",
      note: "offline",
      results: [
        {rank:1, p1:"PlayerB", p2:"PlayerC"},
        {rank:2, p1:"PlayerA", p2:"PlayerD"},
      ]
    },
  ];

  const $ = (s)=>document.querySelector(s);

  const tabs = [
    {key:"singles", label:"シングルス"},
    {key:"doubles", label:"ダブルス"},
  ];

  function setActiveTab(key){
    tabs.forEach(t=>{
      $("#tab_"+t.key).classList.toggle("active", t.key===key);
      $("#"+t.key).classList.toggle("active", t.key===key);
    });
    updatePill(key);
  }

  function badgeClass(rank){
    if(rank===1) return "badge r1";
    if(rank===2) return "badge r2";
    if(rank===3) return "badge r3";
    return "badge";
  }

  function pointsLabel(){
    const s = [];
    for(let r=1;r<=8;r++) s.push(`${r}位:${singlesPoints[r]}`);
    return s.join(" / ");
  }

  function splitExamples(){
    return `分配例：1位 ${doublesTeamPoints[1]}→${doublesPerPerson(1)}+${doublesPerPerson(1)} / 4位 ${doublesTeamPoints[4]}→${doublesPerPerson(4)}+${doublesPerPerson(4)} / 8位 ${doublesTeamPoints[8]}→${doublesPerPerson(8)}+${doublesPerPerson(8)}`;
  }

  function updatePill(activeKey){
    const base = `配点：${pointsLabel()}`;
    const pill = $("#pillText");
    if(activeKey==="doubles"){
      pill.innerHTML = `${base}　<b style="font-weight:600">｜</b>　${splitExamples()}`;
      pill.title = `ダブルスはチームptを2人に等分して個人に加算`;
    }else{
      pill.textContent = base;
      pill.title = `シングルス配点`;
    }
  }

  // 同ポイントなら同順位（競技順位：1,1,3…）
  function addTiedRanks(rows){
    let rank = 0;
    let shown = 0;
    let prevPt = null;
    return rows.map(r=>{
      shown += 1;
      if(prevPt === null || r.pt !== prevPt){
        rank = shown;
        prevPt = r.pt;
      }
      return {...r, rank};
    });
  }

  // ★最新TOP3（type + mode）
  function latestEvent(type, mode){
    const list = events
      .filter(e=>e.type===type && e.mode===mode)
      .sort((a,b)=> (a.date < b.date ? 1 : -1));
    return list[0] ?? null;
  }

  function podiumText(type, mode){
    const e = latestEvent(type, mode);
    if(!e) return "—";

    const nameAtRank = (rank)=>{
      const r = (e.results || []).find(x => x.rank === rank);
      if(!r) return "—";
      if(type==="singles") return r.player;
      return `${r.p1}/${r.p2}`;
    };

    const date = e.date ?? "—";
    const tn = e.tournament ?? "—";
    return `${date}　${tn}　1位 ${nameAtRank(1)}　2位 ${nameAtRank(2)}　3位 ${nameAtRank(3)}`;
  }

  // 総合（type全体）
  function computeStats(type){
    const map = new Map(); // name -> {pt,wins,plays}
    const add = (name, pt, isWin)=>{
      const k = name; // 同一扱いしない
      if(!k) return;
      const v = map.get(k) ?? {pt:0,wins:0,plays:0};
      v.pt += pt;
      v.plays += 1;
      if(isWin) v.wins += 1;
      map.set(k, v);
    };

    events.filter(e=>e.type===type).forEach(e=>{
      if(type==="singles"){
        e.results.forEach(r=>{
          add(r.player, singlesPoints[r.rank] ?? 0, r.rank===1);
        });
      }else{
        e.results.forEach(r=>{
          const ptEach = doublesPerPerson(r.rank);
          add(r.p1, ptEach, r.rank===1);
          add(r.p2, ptEach, r.rank===1);
        });
      }
    });

    return Array.from(map.entries())
      .map(([name,v])=>({name, ...v}))
      .sort((a,b)=> b.pt-a.pt || b.wins-a.wins || b.plays-a.plays || a.name.localeCompare(b.name,"ja"));
  }

  // 部門ベスト（type+mode）
  function computeModeStats(type, mode){
    const map = new Map(); // name -> {pt,wins,plays}
    const add = (name, pt, isWin)=>{
      const k = name; // 同一扱いしない
      if(!k) return;
      const v = map.get(k) ?? {pt:0,wins:0,plays:0};
      v.pt += pt;
      v.plays += 1;
      if(isWin) v.wins += 1;
      map.set(k, v);
    };

    events.filter(e=>e.type===type && e.mode===mode).forEach(e=>{
      if(type==="singles"){
        e.results.forEach(r=>{
          add(r.player, singlesPoints[r.rank] ?? 0, r.rank===1);
        });
      }else{
        e.results.forEach(r=>{
          const ptEach = doublesPerPerson(r.rank);
          add(r.p1, ptEach, r.rank===1);
          add(r.p2, ptEach, r.rank===1);
        });
      }
    });

    return Array.from(map.entries())
      .map(([name,v])=>({name, ...v}))
      .sort((a,b)=> b.pt-a.pt || b.wins-a.wins || b.plays-a.plays || a.name.localeCompare(b.name,"ja"));
  }

  function renderOverall(tbodyId, rows){
    const tb = document.getElementById(tbodyId);
    tb.innerHTML = "";
    if(rows.length===0){
      tb.innerHTML = `<tr><td colspan="5" class="muted">まだデータがありません（eventsに追記してね）</td></tr>`;
      return;
    }
    const ranked = addTiedRanks(rows);
    ranked.forEach((r)=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="mono">${r.rank}</td>
        <td>${r.name}</td>
        <td class="right mono">${r.pt}</td>
        <td class="right mono">${r.wins}</td>
        <td class="right mono">${r.plays}</td>
      `;
      tb.appendChild(tr);
    });
  }

  function renderModeCard(targetId, title, rows){
    const wrap = document.createElement("div");
    wrap.className = "card";

    const h2 = document.createElement("h2");
    const left = document.createElement("span");
    left.textContent = title;
    const right = document.createElement("span");
    right.className = "tag";
    right.innerHTML = `<span style="color:var(--accent2)">◆</span> best`;
    h2.appendChild(left); h2.appendChild(right);

    const content = document.createElement("div");
    content.style.overflow = "auto";

    const table = document.createElement("table");
    table.innerHTML = `
      <thead>
        <tr>
          <th class="rank">順位</th>
          <th>プレイヤー</th>
          <th class="right">pt</th>
          <th class="right">優勝</th>
          <th class="right">出場</th>
        </tr>
      </thead>
      <tbody></tbody>
    `;
    const tb = table.querySelector("tbody");

    const top = rows.slice(0,8);
    if(top.length===0){
      tb.innerHTML = `<tr><td colspan="5" class="muted">まだ記録がありません（eventsに追記してね）</td></tr>`;
    }else{
      const ranked = addTiedRanks(top);
      ranked.forEach((r)=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td class="rank"><span class="${badgeClass(r.rank)}"><span class="mono">#${r.rank}</span></span></td>
          <td>${r.name}</td>
          <td class="right mono">${r.pt}</td>
          <td class="right mono">${r.wins}</td>
          <td class="right mono">${r.plays}</td>
        `;
        tb.appendChild(tr);
      });
    }

    content.appendChild(table);
    wrap.appendChild(h2);
    wrap.appendChild(content);
    document.getElementById(targetId).appendChild(wrap);
  }

  function init(){
    // tabs
    const tabsWrap = $("#tabs");
    tabsWrap.innerHTML = "";
    tabs.forEach(t=>{
      const el = document.createElement("div");
      el.className = "tab" + (t.key==="singles" ? " active" : "");
      el.id = "tab_"+t.key;
      el.textContent = t.label;
      el.onclick = ()=>setActiveTab(t.key);
      tabsWrap.appendChild(el);
    });

    // pill
    $("#pointsLabel").textContent = pointsLabel();
    updatePill("singles");

    // updated times
    const now = new Date().toISOString().slice(0,19).replace("T"," ");
    $("#updatedAtS").textContent = now;
    $("#updatedAtD").textContent = now;

    // ★モード別 最新TOP3
    $("#latestSinglesFever").textContent   = podiumText("singles","fever");
    $("#latestSinglesClassic").textContent = podiumText("singles","classic");
    $("#latestDoublesFever").textContent   = podiumText("doubles","fever");
    $("#latestDoublesClassic").textContent = podiumText("doubles","classic");

    // overall
    renderOverall("singlesOverall", computeStats("singles"));
    renderOverall("doublesOverall", computeStats("doubles"));

    // mode boards (best)
    $("#singlesBoards").innerHTML = "";
    $("#doublesBoards").innerHTML = "";

    renderModeCard("singlesBoards", "フィーバー｜シングルス（累計上位）", computeModeStats("singles","fever"));
    renderModeCard("singlesBoards", "クラシック｜シングルス（累計上位）", computeModeStats("singles","classic"));

    renderModeCard("doublesBoards", "フィーバー｜ダブルス（個人累計上位）", computeModeStats("doubles","fever"));
    renderModeCard("doublesBoards", "クラシック｜ダブルス（個人累計上位）", computeModeStats("doubles","classic"));
  }

  init();
</script>
</body>
</html>



